<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mon Profil - Archetype Guessr</title>

<style>
body {
    margin:0;
    font-family:'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #fdfbfb, #ebedee);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.container {
    background:white;
    padding:40px;
    border-radius:20px;
    box-shadow:0 10px 30px rgba(0,0,0,0.1);
    max-width:600px;
    text-align:center;
}

h1 {
    margin-bottom:20px;
}

.archetype-name {
    font-size:28px;
    font-weight:bold;
    color:#6a5acd;
    margin:20px 0;
}

.description {
    color:#555;
    line-height:1.6;
}

button {
    margin-top:30px;
    padding:10px 20px;
    border:none;
    border-radius:10px;
    background:#6a5acd;
    color:white;
    font-weight:bold;
    cursor:pointer;
}

button:hover {
    background:#5848c2;
}
</style>
</head>

<body>

<div class="container">
  <h1>Votre Profil</h1>

  <div class="archetype-name" id="archetype-name">
    Calcul en cours...
  </div>

  <div class="description" id="archetype-desc"></div>

  <button onclick="goHome()">Retour Accueil</button>
</div>

<script>


//chargement du profil utilisateur du type :
/*
let profile = {
  healthy: 0,
  finance: 0,
  productivite: 0,
  technologie: 0,
  developpement_personnel: 0,
  lifestyle: 0,
  culture: 0,
  sport_performance: 0,
  business: 0,
  societe: 0,
  couple: 0,
  celibataire: 0
};
*/
const profile = JSON.parse(localStorage.getItem("profile")) || {};

let archetypesData = {};


//init
document.addEventListener("DOMContentLoaded", () => {

  fetch('data/archetypes.json')
    .then(res => res.json())
    .then(data => {

      archetypesData = data.archetypes;
      calculateArchetype();

    })
    .catch(err => {
      console.error("Erreur chargement archetypes :", err);
    });

});


//calcul de l'archetype
function calculateArchetype() {

  let bestMatch = null;
  let bestScore = -1;

  for (let archetypeKey in archetypesData) {

    let archetype = archetypesData[archetypeKey];
    let score = 0;

    archetype.tags.forEach(tagCategory => {
      if (profile[tagCategory]) {
        score += profile[tagCategory];
      }
    });

    if (score > bestScore) {
      bestScore = score;
      bestMatch = archetype;
    }
  }

  displayResult(bestMatch);
}


//on affiche
function displayResult(archetype) {

  const nameEl = document.getElementById("archetype-name");
  const descEl = document.getElementById("archetype-desc");

  if (!archetype) {
    nameEl.innerText = "Profil insuffisant";
    descEl.innerText = "Consultez plus d'articles pour obtenir un résultat.";
    return;
  }

  nameEl.innerText = archetype.desc ? archetype.desc.split(".")[0] : "Profil détecté";
  descEl.innerText = archetype.desc;
}



function goHome() {
  window.location.href = "index.html";
}

</script>

</body>
</html>